<div class="docentes-container">
  <div class="header-section">
    <h1 class="page-title">
      <mat-icon>school</mat-icon>
      Gestión de Docentes
    </h1>
    <p class="page-subtitle">
      Administre la información y disponibilidad de los docentes
    </p>
  </div>

  <mat-card class="form-card" elevation="2">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>person_add</mat-icon>
        Agregar Nuevo Docente
      </mat-card-title>
    </mat-card-header>

    <mat-card-content>
      <form
        [formGroup]="docenteForm"
        (ngSubmit)="agregarDocente()"
        class="docente-form"
      >
        <div class="form-row">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Nombre del Docente</mat-label>
            <input
              matInput
              formControlName="nombre"
              placeholder="Ingrese el nombre completo"
              maxlength="50"
            />
            <mat-icon matSuffix>person</mat-icon>
            <mat-hint>Mínimo 2 caracteres, máximo 50</mat-hint>
            <mat-error
              *ngIf="
                docenteForm.get('nombre')?.invalid &&
                docenteForm.get('nombre')?.touched
              "
            >
              {{ getErrorMessage("nombre") }}
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-row">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Disponibilidad Horaria</mat-label>
            <mat-select
              formControlName="disponibilidad"
              multiple
              placeholder="Seleccione hasta 2 horarios"
            >
              <mat-option
                *ngFor="let opcion of opcionesDisponibilidad"
                [value]="opcion.value"
              >
                {{ opcion.viewValue }}
              </mat-option>
            </mat-select>
            <mat-icon matSuffix>schedule</mat-icon>
            <mat-hint>Seleccione máximo 2 horarios de disponibilidad</mat-hint>
            <mat-error
              *ngIf="
                docenteForm.get('disponibilidad')?.invalid &&
                docenteForm.get('disponibilidad')?.touched
              "
            >
              {{ getErrorMessage("disponibilidad") }}
            </mat-error>
          </mat-form-field>
        </div>

        <div class="form-actions">
          <button
            mat-raised-button
            color="primary"
            type="submit"
            [disabled]="docenteForm.invalid || isSubmitting"
            class="submit-button"
          >
            <mat-icon *ngIf="!isSubmitting">add</mat-icon>
            <mat-spinner *ngIf="isSubmitting" diameter="20"></mat-spinner>
            {{ isSubmitting ? "Agregando..." : "Agregar Docente" }}
          </button>

          <button
            mat-button
            type="button"
            (click)="docenteForm.reset()"
            [disabled]="isSubmitting"
          >
            <mat-icon>clear</mat-icon>
            Limpiar
          </button>
        </div>
      </form>
    </mat-card-content>
  </mat-card>

  <mat-divider class="section-divider"></mat-divider>

  <mat-card class="table-card" elevation="2">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>list</mat-icon>
        Lista de Docentes
      </mat-card-title>
      <mat-card-subtitle>
        Total: {{ dataSource.data.length }} docente(s) registrado(s)
      </mat-card-subtitle>
    </mat-card-header>

    <mat-card-content>
      <div class="table-container" *ngIf="!isLoading; else loadingTemplate">
        <table
          mat-table
          [dataSource]="dataSource"
          matSort
          class="docentes-table"
        >
          Columna ID
          <ng-container matColumnDef="id">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>ID</th>
            <td mat-cell *matCellDef="let docente" class="id-cell">
              <span class="id-badge">{{ docente.id }}</span>
            </td>
          </ng-container>

          Columna Nombre
          <ng-container matColumnDef="nombre">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Nombre</th>
            <td mat-cell *matCellDef="let docente" class="nombre-cell">
              <div class="nombre-container">
                <mat-icon class="nombre-icon">person</mat-icon>
                <span class="nombre-text">{{ docente.nombre }}</span>
              </div>
            </td>
          </ng-container>

          Columna Disponibilidad
          <ng-container matColumnDef="disponibilidad">
            <th mat-header-cell *matHeaderCellDef>Disponibilidad</th>
            <td mat-cell *matCellDef="let docente" class="disponibilidad-cell">
              <div class="chips-container">
                <mat-chip-set>
                  <mat-chip
                    *ngFor="let horario of docente.disponibilidadArray"
                    class="horario-chip"
                  >
                    <mat-icon matChipAvatar>schedule</mat-icon>
                    {{ formatearDisponibilidad([horario]) }}
                  </mat-chip>
                </mat-chip-set>
              </div>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr
            mat-row
            *matRowDef="let row; columns: displayedColumns"
            class="table-row"
          ></tr>
        </table>

        <mat-paginator
          [pageSizeOptions]="[5, 10, 20]"
          showFirstLastButtons
          class="table-paginator"
        >
        </mat-paginator>
      </div>

      <ng-template #loadingTemplate>
        <div class="loading-container">
          <mat-spinner diameter="50"></mat-spinner>
          <p class="loading-text">Cargando docentes...</p>
        </div>
      </ng-template>

      <div
        *ngIf="!isLoading && dataSource.data.length === 0"
        class="empty-state"
      >
        <mat-icon class="empty-icon">school</mat-icon>
        <h3>No hay docentes registrados</h3>
        <p>Agregue el primer docente usando el formulario superior</p>
      </div>
    </mat-card-content>
  </mat-card>
</div>
